# TODO.md

## プロジェクト進行状況

### フェーズ1: 基本機能実装 ✅ 完了

#### プロジェクト初期設定
- [x] requirements.txtの作成
- [x] 基本ディレクトリ構造の作成
- [x] 設定ファイルテンプレートの作成
- [x] .gitignoreの設定

#### LLMモジュール (src/llm/)
- [x] LM Studio API接続クラスの実装
- [x] プロンプトテンプレート管理
- [x] 検索判断機能の実装
- [x] 検索クエリ生成機能の実装
- [x] 結果要約機能の実装
- [x] エラーハンドリングの実装

#### スクレイピングモジュール (src/scraper/)
- [x] Bing検索URL生成
- [x] HTMLパース・データ抽出
- [x] レート制限機能（1秒間隔）
- [x] User-Agent設定
- [x] エラーハンドリング・リトライ機能
- [x] 検索結果の構造化

#### キャッシュモジュール (src/cache/)
- [x] SQLiteデータベース設計
- [x] キャッシュテーブル作成
- [x] キャッシュ読み書き機能
- [x] TTL（24時間）管理
- [x] 重複チェック機能

#### CLIモジュール (src/cli/)
- [x] コマンドライン引数解析
- [x] メイン処理フローの実装
- [x] 進捗表示機能
- [x] 設定読み込み機能
- [x] ログ出力設定

#### ユーティリティ (src/utils/)
- [x] 共通設定管理
- [x] ログ設定
- [x] 例外処理クラス
- [x] 設定ファイル管理

### フェーズ2: 機能拡張 📋

#### 統合テストと修正 ✅ 完了
- [x] 依存関係とインポートの修正
- [x] 設定ファイルの動作確認
- [x] CLIコマンドの動作テスト
- [x] エラーハンドリングの検証
- [x] ドキュメント整備（README.md作成）

#### テスト実装
- [ ] ユニットテスト作成
- [ ] モックテスト（LLM、スクレイピング）
- [ ] 統合テスト
- [ ] pytest設定

#### 設定・運用改善
- [x] 設定ファイルバリデーション
- [x] ログレベル設定
- [x] デバッグモード実装
- [ ] パフォーマンス最適化

#### UI/UX改善
- [x] プログレスバー表示
- [ ] カラー出力対応
- [x] ヘルプメッセージ改善
- [x] エラーメッセージ改善

### フェーズ3: 高度な機能 🎯

#### 履歴・メモリ機能
- [ ] チャット履歴テーブル設計
- [ ] 履歴保存機能
- [ ] コンテキスト付き回答生成
- [ ] 履歴検索機能

#### 検索機能拡張
- [ ] 代替検索エンジン対応（DuckDuckGo、Google等）
- [ ] 検索API統合（Bing Search API等）
- [ ] 検索結果の信頼性スコア
- [ ] 関連検索提案
- [ ] 検索結果のランキング

#### システム改善
- [ ] 非同期処理対応
- [ ] 設定GUI（オプション）
- [ ] プラグインシステム
- [ ] API化（将来的）

## 技術的課題

### 優先度: 高 🔥
- [x] LM Studio接続の安定性確保
- [ ] **Bingスクレイピングの制限突破**
  - 現状: Bingの反Bot対策により検索結果が取得できない
  - 解決策候補:
    - より高度なUser-Agent偽装
    - プロキシローテーション
    - セレンium使用（JavaScript実行）
    - 検索API（Bing Search API）への移行
    - 代替検索エンジン（DuckDuckGo等）の追加
- [x] 日本語文字化け対策

### 優先度: 中
- [ ] 大量データ処理時のメモリ効率化
- [ ] 長時間実行時の安定性
- [ ] 複数モデル対応
- [ ] **検索セレクター更新**
  - Bingの新しいHTML構造に対応
  - フォールバック機能の改良

### 優先度: 低
- [ ] 国際化対応
- [ ] 設定のクラウド同期
- [ ] 統計・分析機能

## 既知の制限事項 ⚠️

### Webスクレイピング
- **Bingスクレイピング**: 現在動作不可（Bot検出により検索結果0件）
- **対応状況**: フォールバック機能実装済みだが、根本的解決が必要
- **回避策**: 検索不要な質問は正常動作、LLMの直接回答が利用可能

### システム動作
- **LM Studio連携**: ✅ 完全動作
- **キャッシュシステム**: ✅ 完全動作
- **CLI機能**: ✅ 完全動作
- **エラーハンドリング**: ✅ 堅牢な実装

## 完了したタスク ✅

### フェーズ1: 基本機能実装
- プロジェクト初期セットアップ（設定ファイル、ディレクトリ構造）
- LM Studio API連携とプロンプト管理
- Bingスクレイピング基盤（技術的制限あり）
- SQLiteキャッシュシステム
- CLI インターフェース
- 統合エラーハンドリング

### 統合テスト
- 依存関係解決
- 全機能動作確認
- ドキュメント作成
- Git管理開始